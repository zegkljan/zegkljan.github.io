import{s as h,p as I,r as W}from"./QList.aaf70ef3.js";import{Q as M,a as F,b as E}from"./QTable.b611993f.js";import{C as R,Q as D}from"./country-flag.esm.5a5c322b.js";import{Q as C}from"./QBtn.890232ed.js";import{c as S,h as U,M as q,u as z,N as V,O as r,P as b,Q as n,f as c,a1 as l,Y as f,Z as t,_ as o,a2 as x,$ as p,a0 as Q,F as L,G as A,e as N,ao as G,r as B,ap as H}from"./index.631c22df.js";import{a as O,b as Y,Q as Z,C as j}from"./ClosePopup.21ec9f51.js";import{c as J,e as K,Q as X}from"./use-router-link.1aac45d5.js";import{u as P}from"./vue-i18n.esm-bundler.c64dfdd8.js";import"./rtl.b6e0334c.js";const ee=["top","middle","bottom"];var te=J({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:a=>ee.includes(a)}},setup(a,{slots:k}){const s=S(()=>a.align!==void 0?{verticalAlign:a.align}:null),v=S(()=>{const m=a.outline===!0&&a.color||a.textColor;return`q-badge flex inline items-center no-wrap q-badge--${a.multiLine===!0?"multi":"single"}-line`+(a.outline===!0?" q-badge--outline":a.color!==void 0?` bg-${a.color}`:"")+(m!==void 0?` text-${m}`:"")+(a.floating===!0?" q-badge--floating":"")+(a.rounded===!0?" q-badge--rounded":"")+(a.transparent===!0?" q-badge--transparent":"")});return()=>U("div",{class:v.value,style:s.value,role:"alert","aria-label":a.label},K(k.default,a.label!==void 0?[a.label]:[]))}});const ae={class:"text-h6"},le={key:1,class:"club"},ne={class:"text-left"},oe={class:"text-left"},ie={class:"text-center"},re={class:"text-center"},se={class:"text-center"},de={class:"text-center"},ue={class:"text-center"},ce={class:"text-center"},fe={class:"text-center"},me={class:"text-left"},he={class:"text-left"},be={class:"text-center"},ge={class:"text-center"},_e={class:"text-center"},ve={class:"text-right"},ye={class:"coefficient-tooltip",cellspacing:"0"},pe={class:"text-right"},ke={class:"text-right"},Te={class:"text-center"},we={class:"text-center"},$e={class:"text-center"},Ce=q({__name:"LadderDetail",props:{modelValue:null,division:null,category:null},emits:["update:modelValue","tournamentDetail"],setup(a,{emit:k}){const s=a,{t:v}=P(),m=z(),T=V({get(){return s.modelValue!=null},set(i){k("update:modelValue",i?s.modelValue:null)}});function $(i){var y,u,w;if(!(s.division===null||s.category===null))return(w=(u=(y=m.tournaments)==null?void 0:y[i].competitions[s.division])==null?void 0:u[s.category])==null?void 0:w.results_link}return(i,y)=>(r(),b(W,{modelValue:o(T),"onUpdate:modelValue":y[0]||(y[0]=u=>N(T)?T.value=u:null)},{default:n(()=>[c(Z,{class:"fit-content"},{default:n(()=>[c(O,null,{default:n(()=>[l("div",ae,[f(t(o(m).people[a.modelValue.fencer_id].name)+" "+t(o(m).people[a.modelValue.fencer_id].surname)+" ",1),a.modelValue.fencer_id.startsWith("-")?x("",!0):(r(),b(C,{key:0,href:"https://hemaratings.com/fighters/details/"+a.modelValue.fencer_id,target:"_blank",icon:"mdi-open-in-new",flat:"",dense:"",round:""},{default:n(()=>[c(h,null,{default:n(()=>[f(t(i.$t("ladderTable.fencerDetail.hemaratingsFencerLinkLabel")),1)]),_:1})]),_:1},8,["href"])),o(m).people[a.modelValue.fencer_id].club_id?(r(),p("span",le,[f(t(o(m).clubs[o(m).people[a.modelValue.fencer_id].club_id].name)+" ",1),o(m).people[a.modelValue.fencer_id].club_id.startsWith("-")?x("",!0):(r(),b(C,{key:0,href:"https://hemaratings.com/clubs/details/"+o(m).people[a.modelValue.fencer_id].club_id,target:"_blank",icon:"mdi-open-in-new",size:"sm",flat:"",dense:"",round:""},{default:n(()=>[c(h,null,{default:n(()=>[f(t(i.$t("ladderTable.fencerDetail.hemaratingsClubLinkLabel")),1)]),_:1})]),_:1},8,["href"]))])):x("",!0)])]),_:1}),c(M,{square:"",flat:"",class:"fit-content"},{default:n(()=>[l("thead",null,[l("tr",null,[l("th",ne,t(i.$t("tournamentLabel")),1),l("th",oe,t(i.$t("dateLabel")),1),l("th",ie,t(i.$t("countryLabel")),1),l("th",re,t(i.$t("noParticipantsLabel")),1),l("th",se,t(i.$t("ladderTable.fencerDetail.rank")),1),l("th",de,t(i.$t("coefficientLabel")),1),l("th",ue,t(i.$t("ladderTable.fencerDetail.points")),1),l("th",ce,t(i.$t("ladderTable.fencerDetail.tournamentResultsLabel")),1),l("th",fe,t(i.$t("ladderTable.fencerDetail.tournamentDetailLabel")),1)])]),l("tbody",null,[(r(!0),p(L,null,Q(a.modelValue.tournaments,u=>{var w;return r(),p("tr",{key:u.tournament_id},[l("td",me,t(o(m).tournaments[u.tournament_id].name),1),l("td",he,t(i.$d(o(m).tournaments[u.tournament_id].date)),1),l("td",be,[c(o(R),{country:o(m).tournaments[u.tournament_id].country,shadow:!0,size:"normal"},null,8,["country"]),c(h,null,{default:n(()=>[f(t(i.$t("countries."+o(m).tournaments[u.tournament_id].country)),1)]),_:2},1024)]),l("td",ge,t(o(m).tournaments[u.tournament_id].competitions[a.division][a.category].no_participants),1),l("td",_e,t((w=o(m).tournaments[u.tournament_id].competitions[a.division][a.category].results.find(g=>g.fencer_id==a.modelValue.fencer_id))==null?void 0:w.rank),1),l("td",ve,[f(t(Math.round(u.coefficients.map(g=>g.c).reduce((g,e)=>g*e,1)*100)/100)+" ",1),c(te,{color:"transparent","text-color":"black",class:"coeff-badge"},{default:n(()=>[c(X,{name:"mdi-information-outline"}),c(h,null,{default:n(()=>[l("table",ye,[(r(!0),p(L,null,Q(u.coefficients,g=>(r(),p("tr",{key:g.type},[l("td",null,t(i.$t("ladderTable.fencerDetail.coefficientType."+g.type)),1),l("td",pe,t(g.c),1)]))),128)),l("tr",null,[l("td",null,t(i.$t("ladderTable.fencerDetail.coefficientTotal")),1),l("td",ke,t(Math.round(u.coefficients.map(g=>g.c).reduce((g,e)=>g*e,1)*100)/100),1)])])]),_:2},1024)]),_:2},1024)]),l("td",Te,t(u.points),1),l("td",we,[l("div",null,[c(C,{href:$(u.tournament_id),target:"_blank",icon:"mdi-open-in-new",flat:"",dense:"",round:"",disable:$(u.tournament_id)===void 0},null,8,["href","disable"]),$(u.tournament_id)===void 0?(r(),b(h,{key:0},{default:n(()=>[f(t(i.$t("resultsNoDetailTooltip")),1)]),_:1})):(r(),b(h,{key:1},{default:n(()=>[f(t(i.$t("resultsDetailTooltip")),1)]),_:1}))])]),l("td",$e,[l("div",null,[c(C,{href:"https://hemaratings.com/events/details/"+u.tournament_id,target:"_blank",icon:"mdi-open-in-new",flat:"",dense:"",round:"",disable:u.tournament_id.startsWith("-")},null,8,["href","disable"]),u.tournament_id.startsWith("-")?(r(),b(h,{key:0},{default:n(()=>[f(t(i.$t("hemaratingsNoDetailTooltip")),1)]),_:1})):(r(),b(h,{key:1},{default:n(()=>[f(t(i.$t("hemaratingsDetailTooltip")),1)]),_:1}))])])])}),128))])]),_:1}),c(I),c(Y,{align:"right",class:"text-primary"},{default:n(()=>[A(c(C,{flat:"",label:o(v)("close")},null,8,["label"]),[[j]])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});const Le={class:"change new"},xe={class:"change worse"},Ve={class:"change better"},De={key:1},Se={class:"text-center text-h2",style:{margin:"2rem"}},Ee=q({__name:"LadderView",props:{season:null,division:null,category:null},setup(a){const k=a,{t:s}=P(),v=z();G(async()=>{await v.loadSeason(k.season)});const m=V(()=>[{name:"rank",label:s("ladderTable.rankLabel"),field:e=>e.rank,align:"right",sortable:!0},{name:"previous-season-change",label:s("ladderTable.previousSeasonChangeLabel"),field:e=>e.last_season_rank===void 0?null:e.rank-e.last_season_rank,align:"center",sortable:!0,style:"width: fit-content; max-width: fit-content",headerStyle:"width: fit-content; max-width: fit-content"},{name:"name",label:s("ladderTable.nameLabel"),field:e=>v.people[e.fencer_id].name,align:"left",sortable:!0,sort:(e,_)=>e.localeCompare(_)},{name:"surname",label:s("ladderTable.surnameLabel"),field:e=>v.people[e.fencer_id].surname,align:"left",sortable:!0,sort:(e,_)=>e.localeCompare(_)},{name:"club",label:s("clubLabel"),field:e=>v.people[e.fencer_id].club_id===void 0?"_":v.clubs[v.people[e.fencer_id].club_id].name,format:e=>e==="_"?s("noClub"):e,align:"left",sortable:!0,sort:(e,_)=>e==="_"?_==="_"?0:1:_==="_"?e==="_"?0:-1:e.localeCompare(_)},{name:"points",label:s("pointsLabel"),field:e=>e.points,align:"right",sortable:!0},{name:"noTournaments",label:s("noTournamentsLabel"),field:e=>e.tournaments.length,align:"right",sortable:!0},{name:"avgPtsPerTournament",label:s("avgPtsPerTournamentLabel"),field:e=>Math.round(e.points/e.tournaments.length*100)/100,align:"right",sortable:!0},{name:"details",label:s("ladderTable.detailsLabel"),field:"",align:"right"}]),T=V(()=>{var e;if(v.laddersIndividual!==void 0){const _=(e=v.laddersIndividual[k.division])==null?void 0:e[k.category];return _===void 0?null:_}});let $={width:"100%",height:"300px"};function i(){$.height=window.innerHeight-98+"px"}window.addEventListener("resize",i),i();let y=B(null);function u(e){y.value=e}let w=B(null);function g(e){w.value={...e,division:k.division}}return(e,_)=>(r(),p(L,null,[o(T)!==null?(r(),b(F,{key:0,ref:"table",columns:o(m),rows:o(T),"row-key":"fencer_id",pagination:{rowsPerPage:0,sortBy:"rank",descending:!1},loading:o(T)===void 0,"binary-state-sort":"","hide-bottom":"",square:"",style:H(o($))},{"header-cell-previous-season-change":n(d=>[c(E,{props:d},{default:n(()=>[f(t(d.col.label)+" ",1),c(h,null,{default:n(()=>[f(t(e.$t("ladderTable.previousSeasonChangeTooltip")),1)]),_:1})]),_:2},1032,["props"])]),"body-cell-previous-season-change":n(d=>[c(D,{props:d},{default:n(()=>[d.value===null?(r(),p(L,{key:0},[l("div",Le,t(d.value),1),c(h,null,{default:n(()=>[f(t(e.$t("ladderTable.previousSeasonChangeNewInSeasonTooltip")),1)]),_:1})],64)):d.value===0?(r(),b(h,{key:1},{default:n(()=>[f(t(e.$t("ladderTable.previousSeasonChangeNoChangeTooltip")),1)]),_:1})):d.value>0?(r(),p(L,{key:2},[l("div",xe,t(d.value),1),d.value==-1?(r(),b(h,{key:0},{default:n(()=>[f(t(o(s)("ladderTable.previousSeasonChangeWorseTooltip.n1")),1)]),_:1})):d.value>-5?(r(),b(h,{key:1},{default:n(()=>[f(t(o(s)("ladderTable.previousSeasonChangeWorseTooltip.n2",d.value)),1)]),_:2},1024)):(r(),b(h,{key:2},{default:n(()=>[f(t(o(s)("ladderTable.previousSeasonChangeWorseTooltip.n5",d.value)),1)]),_:2},1024))],64)):d.value<0?(r(),p(L,{key:3},[l("div",Ve,t(-d.value),1),d.value==-1?(r(),b(h,{key:0},{default:n(()=>[f(t(o(s)("ladderTable.previousSeasonChangeBetterTooltip.n1")),1)]),_:1})):d.value>-5?(r(),b(h,{key:1},{default:n(()=>[f(t(o(s)("ladderTable.previousSeasonChangeBetterTooltip.n2",-d.value)),1)]),_:2},1024)):(r(),b(h,{key:2},{default:n(()=>[f(t(o(s)("ladderTable.previousSeasonChangeBetterTooltip.n5",-d.value)),1)]),_:2},1024))],64)):x("",!0)]),_:2},1032,["props"])]),"body-cell-details":n(d=>[c(D,{props:d},{default:n(()=>[c(C,{onClick:Qe=>u(d.row),flat:"",dense:"",round:"",icon:"mdi-information-outline"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","loading","style"])):(r(),p("div",De,[l("div",Se,t(e.$t("noData")),1)])),o(T)!==null?(r(),b(Ce,{key:2,modelValue:o(y),"onUpdate:modelValue":_[0]||(_[0]=d=>N(y)?y.value=d:y=d),division:a.division,category:a.category,onTournamentDetail:g},null,8,["modelValue","division","category"])):x("",!0)],64))}});export{Ee as default};
