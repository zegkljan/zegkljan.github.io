function se(e){return Object.keys(e).filter(t=>Number.isNaN(Number(t))).map(t=>e[t])}async function b(e){return(await fetch(e)).json()}function S(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function x(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}var T=6e4,A=36e5;function z(e,t){x(1,arguments);var r=t||{},n=r.additionalDigits==null?2:S(r.additionalDigits);if(n!==2&&n!==1&&n!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var a=E(e),s;if(a.date){var i=F(a.date,n);s=H(i.restDateString,i.year)}if(!s||isNaN(s.getTime()))return new Date(NaN);var u=s.getTime(),c=0,d;if(a.time&&(c=L(a.time),isNaN(c)))return new Date(NaN);if(a.timezone){if(d=C(a.timezone),isNaN(d))return new Date(NaN)}else{var o=new Date(u+c),v=new Date(0);return v.setFullYear(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate()),v.setHours(o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds(),o.getUTCMilliseconds()),v}return new Date(u+c+d)}var g={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Y=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,K=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Z=/^([+-])(\d{2})(?::?(\d{2}))?$/;function E(e){var t={},r=e.split(g.dateTimeDelimiter),n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],g.timeZoneDelimiter.test(t.date)&&(t.date=e.split(g.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){var a=g.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function F(e,t){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};var a=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?a:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function H(e,t){if(t===null)return new Date(NaN);var r=e.match(Y);if(!r)return new Date(NaN);var n=!!r[4],a=N(r[1]),s=N(r[2])-1,i=N(r[3]),u=N(r[4]),c=N(r[5])-1;if(n)return J(t,u,c)?G(t,u,c):new Date(NaN);var d=new Date(0);return!$(t,s,i)||!P(t,a)?new Date(NaN):(d.setUTCFullYear(t,s,Math.max(a,i)),d)}function N(e){return e?parseInt(e):1}function L(e){var t=e.match(K);if(!t)return NaN;var r=R(t[1]),n=R(t[2]),a=R(t[3]);return B(r,n,a)?r*A+n*T+a*1e3:NaN}function R(e){return e&&parseFloat(e.replace(",","."))||0}function C(e){if(e==="Z")return 0;var t=e.match(Z);if(!t)return 0;var r=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return V(n,a)?r*(n*A+a*T):NaN}function G(e,t,r){var n=new Date(0);n.setUTCFullYear(e,0,4);var a=n.getUTCDay()||7,s=(t-1)*7+r+1-a;return n.setUTCDate(n.getUTCDate()+s),n}var W=[31,null,31,30,31,30,31,31,30,31,30,31];function U(e){return e%400===0||e%4===0&&e%100!==0}function $(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(W[t]||(U(e)?29:28))}function P(e,t){return t>=1&&t<=(U(e)?366:365)}function J(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function B(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function V(e,t){return t>=0&&t<=59}var q=(e=>(e.CZ="cz",e.ALL="all",e))(q||{}),Q=(e=>(e.CZ="cz",e.ALL="all",e))(Q||{}),X=(e=>(e.LS="ls",e.SB="sb",e.R="r",e.RD="rd",e))(X||{});const j={ls:"ls",sb:"sb",r:"r",rd:"rd"};var ee=(e=>(e.MO="mo",e.W="w",e))(ee||{});const M={mo:"mo",w:"w"};var te=(e=>(e[e.TOURNAMENT=0]="TOURNAMENT",e[e.FOREIGN=1]="FOREIGN",e[e.HIGHER_CATEGORY=2]="HIGHER_CATEGORY",e[e.RANK_1=3]="RANK_1",e[e.RANK_2=4]="RANK_2",e[e.RANK_3=5]="RANK_3",e[e.RANK_4=6]="RANK_4",e))(te||{});function re(e){const t={};return Object.keys(e).forEach(r=>{t[r]={name:e[r].name,date:z(e[r].date),country:e[r].country,coefficient:e[r].coefficient,results:ne(e[r].results)}}),t}function ne(e){const t={};for(const r in e){const n=e[r],a={};for(const s in n)a[M[s]]=n[s];t[j[r]]=a}return t}async function ue(){return re(await b("data/tournaments.json"))}function ae(e){const t={};return Object.keys(e).forEach(r=>{t[r]={name:e[r].name,surname:e[r].surname,clubID:e[r].clubID,nationality:e[r].nationality,category:M[e[r].category]}}),t}async function oe(){return ae(await b("data/people.json"))}function ie(e){const t={};return Object.keys(e).forEach(r=>{t[r]={name:e[r].name,country:e[r].country}}),t}async function ce(){return ie(await b("data/clubs.json"))}function le(e,t,r,n,a,s,i){const u={};for(const v in e){const l=e[v];if(i.tournaments!="all"&&l.country!=i.tournaments)continue;const p=l.results[n];if(!p)continue;const h=a,D=p[h];if(!D)continue;const y=D.length;D.forEach(f=>{const I=t[f.id];if(!I||i.fencers!="all"&&r[I.clubID].country!=i.fencers)return;const m=[{type:0,value:l.coefficient}];switch(s&&l.country!=r[t[f.id].clubID].country&&m.push({type:1,value:i.coefficients.foreignTournament}),h!=a&&m.push({type:2,value:i.coefficients.higherCategory}),f.rank){case 1:m.push({type:3,value:i.coefficients.place.first});break;case 2:m.push({type:4,value:i.coefficients.place.second});break;case 3:m.push({type:5,value:i.coefficients.place.third});break;case 4:m.push({type:6,value:i.coefficients.place.fourth});break}const _=m.map(w=>w.value).reduce((w,k)=>w*k,1),O=Math.round((y-f.rank+1)*_);u.hasOwnProperty(f.id)||(u[f.id]={fencerID:f.id,rank:0,points:0,tournaments:[]}),u[f.id].points=u[f.id].points+O,u[f.id].tournaments.push({tournamentID:v,category:h,points:O,coefficients:m})})}const c=Array(Object.keys(u).length);let d=1,o=0;for(const v of Object.keys(u).sort((l,p)=>u[p].points-u[l].points)){const l=u[v];o-1>=0&&c[o-1].points==l.points?l.rank=c[o-1].rank:l.rank=d,c[o]=l,d++,o++}return{category:a,fencerNationality:i.fencers,tournamentsCountry:i.tournaments,entries:c}}export{ee as C,X as D,q as F,Q as T,te as a,oe as b,ue as c,le as d,se as g,ce as l};
