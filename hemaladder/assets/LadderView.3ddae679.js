import{u as ve,a as pe,b as Te,d as ye,e as xe,w as ke,p as F,m as we,q as Z,n as M,s as y,r as Ce}from"./QList.28074f80.js";import{Q as Se,a as Le,b as J}from"./QTable.56332f55.js";import{C as $e,Q as X}from"./country-flag.esm.180d533c.js";import{Q as B}from"./QBtn.69da3013.js";import{m as le,h as k,a4 as Ie,ao as Ve,r as E,c as L,w as H,g as qe,G as oe,ap as De,B as Qe,M as A,u as G,O as u,P as T,Q as o,a1 as s,Z as n,$,a0 as ee,Y as b,_ as c,aq as te,f as m,a2 as P,F as Q,ar as Be,N as W,e as ie,as as Pe,at as Ne}from"./index.29ac57f4.js";import{a as j,b as ze,Q as Ee,C as Oe}from"./ClosePopup.0e7ed73c.js";import{c as U,g as re,h as Me,Q as O,e as He}from"./use-router-link.fb37d025.js";import{u as se}from"./vue-i18n.esm-bundler.990b5f7b.js";import"./rtl.9aeaf1ce.js";var je=U({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(e,{slots:w,emit:r}){let _=!1,a,v,l,C,g,f;function x(){a&&a(),a=null,_=!1,clearTimeout(l),clearTimeout(C),v!==void 0&&v.removeEventListener("transitionend",g),g=null}function t(h,S,I){h.style.overflowY="hidden",S!==void 0&&(h.style.height=`${S}px`),h.style.transition=`height ${e.duration}ms cubic-bezier(.25, .8, .50, 1)`,_=!0,a=I}function p(h,S){h.style.overflowY=null,h.style.height=null,h.style.transition=null,x(),S!==f&&r(S)}function i(h,S){let I=0;v=h,_===!0?(x(),I=h.offsetHeight===h.scrollHeight?0:void 0):f="hide",t(h,I,S),l=setTimeout(()=>{h.style.height=`${h.scrollHeight}px`,g=V=>{(Object(V)!==V||V.target===h)&&p(h,"show")},h.addEventListener("transitionend",g),C=setTimeout(g,e.duration*1.1)},100)}function N(h,S){let I;v=h,_===!0?x():(f="show",I=h.scrollHeight),t(h,I,S),l=setTimeout(()=>{h.style.height=0,g=V=>{(Object(V)!==V||V.target===h)&&p(h,"hide")},h.addEventListener("transitionend",g),C=setTimeout(g,e.duration*1.1)},100)}return le(()=>{_===!0&&x()}),()=>k(Ie,{css:!1,appear:e.appear,onEnter:i,onLeave:N},w.default)}});const D=Ve({}),Re=Object.keys(re);var ne=U({name:"QExpansionItem",props:{...re,...ve,...pe,icon:String,label:String,labelLines:[Number,String],caption:String,captionLines:[Number,String],dense:Boolean,expandIcon:String,expandedIcon:String,expandIconClass:[Array,String,Object],duration:Number,headerInsetLevel:Number,contentInsetLevel:Number,expandSeparator:Boolean,defaultOpened:Boolean,expandIconToggle:Boolean,switchToggleSide:Boolean,denseToggle:Boolean,group:String,popup:Boolean,headerStyle:[Array,String,Object],headerClass:[Array,String,Object]},emits:[...Te,"click","after-show","after-hide"],setup(e,{slots:w,emit:r}){const{proxy:{$q:_}}=qe(),a=ye(e,_),v=E(e.modelValue!==null?e.modelValue:e.defaultOpened),l=E(null),{hide:C,toggle:g}=xe({showing:v});let f,x;const t=L(()=>`q-expansion-item q-item-type q-expansion-item--${v.value===!0?"expanded":"collapsed"} q-expansion-item--${e.popup===!0?"popup":"standard"}`),p=L(()=>{if(e.contentInsetLevel===void 0)return null;const d=_.lang.rtl===!0?"Right":"Left";return{["padding"+d]:e.contentInsetLevel*56+"px"}}),i=L(()=>e.disable!==!0&&(e.href!==void 0||e.to!==void 0&&e.to!==null&&e.to!=="")),N=L(()=>{const d={};return Re.forEach(q=>{d[q]=e[q]}),d}),h=L(()=>i.value===!0||e.expandIconToggle!==!0),S=L(()=>e.expandedIcon!==void 0&&v.value===!0?e.expandedIcon:e.expandIcon||_.iconSet.expansionItem[e.denseToggle===!0?"denseIcon":"icon"]),I=L(()=>e.disable!==!0&&(i.value===!0||e.expandIconToggle===!0));H(()=>e.group,d=>{x!==void 0&&x(),d!==void 0&&Y()});function V(d){i.value!==!0&&g(d),r("click",d)}function de(d){d.keyCode===13&&K(d,!0)}function K(d,q){q!==!0&&l.value!==null&&l.value.focus(),g(d),Qe(d)}function ue(){r("after-show")}function ce(){r("after-hide")}function Y(){f===void 0&&(f=ke()),v.value===!0&&(D[e.group]=f);const d=H(v,z=>{z===!0?D[e.group]=f:D[e.group]===f&&delete D[e.group]}),q=H(()=>D[e.group],(z,_e)=>{_e===f&&z!==void 0&&z!==f&&C()});x=()=>{d(),q(),D[e.group]===f&&delete D[e.group],x=void 0}}function me(){const d={class:[`q-focusable relative-position cursor-pointer${e.denseToggle===!0&&e.switchToggleSide===!0?" items-end":""}`,e.expandIconClass],side:e.switchToggleSide!==!0,avatar:e.switchToggleSide},q=[k(O,{class:"q-expansion-item__toggle-icon"+(e.expandedIcon===void 0&&v.value===!0?" q-expansion-item__toggle-icon--rotated":""),name:S.value})];return I.value===!0&&(Object.assign(d,{tabindex:0,onClick:K,onKeyup:de}),q.unshift(k("div",{ref:l,class:"q-expansion-item__toggle-focus q-icon q-focus-helper q-focus-helper--rounded",tabindex:-1}))),k(M,d,()=>q)}function fe(){let d;return w.header!==void 0?d=[].concat(w.header()):(d=[k(M,()=>[k(Z,{lines:e.labelLines},()=>e.label||""),e.caption?k(Z,{lines:e.captionLines,caption:!0},()=>e.caption):null])],e.icon&&d[e.switchToggleSide===!0?"push":"unshift"](k(M,{side:e.switchToggleSide===!0,avatar:e.switchToggleSide!==!0},()=>k(O,{name:e.icon})))),e.disable!==!0&&d[e.switchToggleSide===!0?"unshift":"push"](me()),d}function he(){const d={ref:"item",style:e.headerStyle,class:e.headerClass,dark:a.value,disable:e.disable,dense:e.dense,insetLevel:e.headerInsetLevel};return h.value===!0&&(d.clickable=!0,d.onClick=V,i.value===!0&&Object.assign(d,N.value)),k(we,d,fe)}function ge(){return oe(k("div",{key:"e-content",class:"q-expansion-item__content relative-position",style:p.value},Me(w.default)),[[De,v.value]])}function be(){const d=[he(),k(je,{duration:e.duration,onShow:ue,onHide:ce},ge)];return e.expandSeparator===!0&&d.push(k(F,{class:"q-expansion-item__border q-expansion-item__border--top absolute-top",dark:a.value}),k(F,{class:"q-expansion-item__border q-expansion-item__border--bottom absolute-bottom",dark:a.value})),d}return e.group!==void 0&&Y(),le(()=>{x!==void 0&&x()}),()=>k("div",{class:t.value},[k("div",{class:"q-expansion-item__container relative-position"},be())])}});const Fe=["top","middle","bottom"];var ae=U({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:e=>Fe.includes(e)}},setup(e,{slots:w}){const r=L(()=>e.align!==void 0?{verticalAlign:e.align}:null),_=L(()=>{const a=e.outline===!0&&e.color||e.textColor;return`q-badge flex inline items-center no-wrap q-badge--${e.multiLine===!0?"multi":"single"}-line`+(e.outline===!0?" q-badge--outline":e.color!==void 0?` bg-${e.color}`:"")+(a!==void 0?` text-${a}`:"")+(e.floating===!0?" q-badge--floating":"")+(e.rounded===!0?" q-badge--rounded":"")+(e.transparent===!0?" q-badge--transparent":"")});return()=>k("div",{class:_.value,style:r.value,role:"alert","aria-label":e.label},He(w.default,e.label!==void 0?[e.label]:[]))}});const We={class:"text-left"},Ae={class:"text-left"},Ge={class:"text-center"},Ue={class:"text-center"},Ke={class:"text-center"},Ye={class:"text-center"},Ze={class:"text-center"},Je={class:"text-center"},Xe={class:"text-center"},et={class:"text-left"},tt={class:"text-left"},nt={class:"text-center"},at={class:"text-center"},lt={class:"text-center"},ot={class:"text-right"},it={class:"coefficient-tooltip",cellspacing:"0"},rt={class:"text-right"},st={class:"text-right"},dt={class:"text-center"},ut={class:"text-center"},ct={class:"text-center"},R=A({__name:"IndividualTournamentsDetail",props:{fencerId:null,tournaments:null},setup(e){const w=e,r=G(),_=L(()=>w.tournaments.flatMap(a=>r.tournaments===void 0?[]:[{competition:r.tournaments[a.tournament_id].competitions[a.competition_idx],tournament:a}]));return(a,v)=>(u(),T(Se,{square:"",flat:"",class:"fit-content"},{default:o(()=>[s("thead",null,[s("tr",null,[s("th",We,n(a.$t("tournamentLabel")),1),s("th",Ae,n(a.$t("dateLabel")),1),s("th",Ge,n(a.$t("countryLabel")),1),s("th",Ue,n(a.$t("noParticipantsLabel")),1),s("th",Ke,n(a.$t("ladderTable.fencerDetail.rank")),1),s("th",Ye,n(a.$t("coefficientLabel")),1),s("th",Ze,n(a.$t("ladderTable.fencerDetail.points")),1),s("th",Je,n(a.$t("ladderTable.fencerDetail.tournamentResultsLabel")),1),s("th",Xe,n(a.$t("ladderTable.fencerDetail.tournamentDetailLabel")),1)])]),s("tbody",null,[(u(!0),$(Q,null,ee(c(_),l=>{var C,g;return u(),$("tr",{key:l.tournament.tournament_id+((C=l.competition.subtitle)!=null?C:"")},[s("td",et,[b(n(c(r).tournaments[l.tournament.tournament_id].name+(l.competition.subtitle===void 0?"":" ("+l.competition.subtitle+")"))+" ",1),c(r).tournaments[l.tournament.tournament_id].championship?(u(),T(ae,{key:0,name:"mdi-trophy",color:"transparent","text-color":"black",class:te(["coeff-badge",{hide:l.tournament.coefficients.length===0}])},{default:o(()=>[m(O,{name:"mdi-trophy",class:"championship",size:"larger"}),m(y,null,{default:o(()=>[b(n(a.$t("championship")),1)]),_:1})]),_:2},1032,["class"])):P("",!0)]),s("td",tt,n(a.$d(c(r).tournaments[l.tournament.tournament_id].date)),1),s("td",nt,[m(c($e),{country:c(r).tournaments[l.tournament.tournament_id].country,shadow:!0,size:"normal"},null,8,["country"]),m(y,null,{default:o(()=>[b(n(a.$t("countries."+c(r).tournaments[l.tournament.tournament_id].country)),1)]),_:2},1024)]),s("td",at,n(l.competition.no_participants),1),s("td",lt,n((g=l.competition.results.find(f=>f.fencer_id==e.fencerId))==null?void 0:g.rank),1),s("td",ot,[b(n(Math.round(l.tournament.coefficients.map(f=>f.c).reduce((f,x)=>f*x,1)*100)/100)+" ",1),m(ae,{color:"transparent","text-color":"black",class:te(["coeff-badge",{hide:l.tournament.coefficients.length===0}])},{default:o(()=>[m(O,{name:"mdi-information-outline"}),m(y,null,{default:o(()=>[s("table",it,[(u(!0),$(Q,null,ee(l.tournament.coefficients,f=>(u(),$("tr",{key:f.type},[s("td",null,n(a.$t("ladderTable.fencerDetail.coefficientType."+f.type)),1),s("td",rt,n(f.c),1)]))),128)),s("tr",null,[s("td",null,n(a.$t("ladderTable.fencerDetail.coefficientTotal")),1),s("td",st,n(Math.round(l.tournament.coefficients.map(f=>f.c).reduce((f,x)=>f*x,1)*100)/100),1)])])]),_:2},1024)]),_:2},1032,["class"])]),s("td",dt,n(l.tournament.points),1),s("td",ut,[s("div",null,[m(B,{href:l.competition.results_link,target:"_blank",icon:"mdi-open-in-new",flat:"",dense:"",round:"",disable:l.competition.results_link===void 0},null,8,["href","disable"]),l.competition.results_link===void 0?(u(),T(y,{key:0},{default:o(()=>[b(n(a.$t("resultsNoDetailTooltip")),1)]),_:1})):(u(),T(y,{key:1},{default:o(()=>[b(n(a.$t("resultsDetailTooltip")),1)]),_:1}))])]),s("td",ct,[s("div",null,[m(B,{href:"https://hemaratings.com/events/details/"+l.tournament.tournament_id,target:"_blank",icon:"mdi-open-in-new",flat:"",dense:"",round:"",disable:l.tournament.tournament_id.startsWith("-")},null,8,["href","disable"]),l.tournament.tournament_id.startsWith("-")?(u(),T(y,{key:0},{default:o(()=>[b(n(a.$t("hemaratingsNoDetailTooltip")),1)]),_:1})):(u(),T(y,{key:1},{default:o(()=>[b(n(a.$t("hemaratingsDetailTooltip")),1)]),_:1}))])])])}),128))])]),_:1}))}});const mt={class:"text-h6"},ft={key:1,class:"club"},ht={class:"table-container"},gt={class:"table-container"},bt=A({__name:"LadderDetail",props:{modelValue:null},emits:["update:modelValue","tournamentDetail"],setup(e,{emit:w}){const r=e,{t:_}=se(),a=G(),v=W({get(){return r.modelValue!=null},set(l){w("update:modelValue",l?r.modelValue:null)}});return(l,C)=>(u(),T(Ce,{modelValue:c(v),"onUpdate:modelValue":C[0]||(C[0]=g=>ie(v)?v.value=g:null)},{default:o(()=>[m(Ee,{class:"fit-content"},{default:o(()=>[m(j,null,{default:o(()=>{var g;return[s("div",mt,[b(n(c(a).people[e.modelValue.fencer_id].name)+" "+n(c(a).people[e.modelValue.fencer_id].surname)+" ",1),e.modelValue.fencer_id.startsWith("-")?P("",!0):(u(),T(B,{key:0,href:"https://hemaratings.com/fighters/details/"+e.modelValue.fencer_id,target:"_blank",icon:"mdi-open-in-new",flat:"",dense:"",round:""},{default:o(()=>[m(y,null,{default:o(()=>[b(n(l.$t("ladderTable.fencerDetail.hemaratingsFencerLinkLabel")),1)]),_:1})]),_:1},8,["href"])),(g=c(a).peopleClubs)!=null&&g[e.modelValue.fencer_id]?(u(),$("span",ft,[b(n(c(a).clubs[c(a).peopleClubs[e.modelValue.fencer_id]].name)+" ",1),c(a).peopleClubs[e.modelValue.fencer_id].startsWith("-")?P("",!0):(u(),T(B,{key:0,href:"https://hemaratings.com/clubs/details/"+c(a).peopleClubs[e.modelValue.fencer_id],target:"_blank",icon:"mdi-open-in-new",size:"sm",flat:"",dense:"",round:""},{default:o(()=>[m(y,null,{default:o(()=>[b(n(l.$t("ladderTable.fencerDetail.hemaratingsClubLinkLabel")),1)]),_:1})]),_:1},8,["href"]))])):P("",!0)])]}),_:1}),e.modelValue.uncounted_tournaments.length>0?(u(),T(j,{key:0},{default:o(()=>[m(ne,{label:l.$t("ladderTable.fencerDetail.countedTournaments"),"model-value":!0,"header-class":"text-subtitle1 text-weight-medium"},{default:o(()=>[s("div",ht,[m(R,{"fencer-id":e.modelValue.fencer_id,tournaments:e.modelValue.counted_tournaments},null,8,["fencer-id","tournaments"])])]),_:1},8,["label"]),m(ne,{label:l.$t("ladderTable.fencerDetail.uncountedTournaments"),"header-class":"text-subtitle1 text-weight-medium"},{default:o(()=>[s("div",gt,[m(R,{"fencer-id":e.modelValue.fencer_id,tournaments:e.modelValue.uncounted_tournaments},null,8,["fencer-id","tournaments"])])]),_:1},8,["label"])]),_:1})):(u(),T(j,{key:1},{default:o(()=>[m(R,{"fencer-id":e.modelValue.fencer_id,tournaments:e.modelValue.counted_tournaments},null,8,["fencer-id","tournaments"])]),_:1})),m(F),m(ze,{align:"right",class:"text-primary"},{default:o(()=>[oe(m(B,{flat:"",label:c(_)("close")},null,8,["label"]),[[Oe]])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});var _t=Be(bt,[["__scopeId","data-v-73129f5e"]]);const vt={class:"change new"},pt={class:"change worse"},Tt={class:"change better"},yt={key:1},xt={class:"text-center text-h2",style:{margin:"2rem"}},Dt=A({__name:"LadderView",props:{season:null,division:null,category:null},setup(e){const w=e,{t:r}=se(),_=G();Pe(async()=>{await _.loadSeason(w.season)});const a=W(()=>[{name:"rank",label:r("ladderTable.rankLabel"),field:t=>t.rank,align:"right",sortable:!0},{name:"previous-season-change",label:r("ladderTable.previousSeasonChangeLabel"),field:t=>t.last_season_rank===void 0?null:t.rank-t.last_season_rank,align:"center",sortable:!0,style:"width: fit-content; max-width: fit-content",headerStyle:"width: fit-content; max-width: fit-content"},{name:"name",label:r("ladderTable.nameLabel"),field:t=>_.people[t.fencer_id].name,align:"left",sortable:!0,sort:(t,p)=>t.localeCompare(p)},{name:"surname",label:r("ladderTable.surnameLabel"),field:t=>_.people[t.fencer_id].surname,align:"left",sortable:!0,sort:(t,p)=>t.localeCompare(p)},{name:"club",label:r("clubLabel"),field:t=>{var i;const p=(i=_.peopleClubs)==null?void 0:i[t.fencer_id];return p===void 0?"_":_.clubs[p].name},format:t=>t==="_"?r("noClub"):t,align:"left",sortable:!0,sort:(t,p)=>t==="_"?p==="_"?0:1:p==="_"?t==="_"?0:-1:t.localeCompare(p)},{name:"points",label:r("pointsLabel"),field:t=>t.points,align:"right",sortable:!0},{name:"noCountedTournaments",label:r("ladderTable.noCountedTournamentsLabel"),field:t=>t.counted_tournaments.length,align:"right",sortable:!0},{name:"noTotalTournaments",label:r("ladderTable.noTotalTournamentsLabel"),field:t=>t.counted_tournaments.length+t.uncounted_tournaments.length,align:"right",sortable:!0},{name:"avgPtsPerTournament",label:r("ladderTable.avgPtsPerTournamentLabel"),field:t=>Math.round(t.points/t.counted_tournaments.length*100)/100,align:"right",sortable:!0},{name:"details",label:r("ladderTable.detailsLabel"),field:"",align:"right"}]),v=W(()=>{var t;if(_.laddersIndividual!==void 0){const p=(t=_.laddersIndividual[w.division])==null?void 0:t[w.category];return p===void 0?null:p}});let l={width:"100%",height:"300px"};function C(){l.height=window.innerHeight-98+"px"}window.addEventListener("resize",C),C();let g=E(null);function f(t){g.value=t}E(null);function x(t){}return(t,p)=>(u(),$(Q,null,[c(v)!==null?(u(),T(Le,{key:0,ref:"table",columns:c(a),rows:c(v),"row-key":"fencer_id",pagination:{rowsPerPage:0,sortBy:"rank",descending:!1},loading:c(v)===void 0,"binary-state-sort":"","hide-bottom":"",square:"",style:Ne(c(l))},{"header-cell-previous-season-change":o(i=>[m(J,{props:i},{default:o(()=>[b(n(i.col.label)+" ",1),m(y,null,{default:o(()=>[b(n(t.$t("ladderTable.previousSeasonChangeTooltip")),1)]),_:1})]),_:2},1032,["props"])]),"header-cell-avgPtsPerTournament":o(i=>[m(J,{props:i},{default:o(()=>[b(n(i.col.label)+" ",1),m(y,null,{default:o(()=>[b(n(t.$t("ladderTable.avgPtsPerTournamentTooltip")),1)]),_:1})]),_:2},1032,["props"])]),"body-cell-previous-season-change":o(i=>[m(X,{props:i},{default:o(()=>[i.value===null?(u(),$(Q,{key:0},[s("div",vt,n(i.value),1),m(y,null,{default:o(()=>[b(n(t.$t("ladderTable.previousSeasonChangeNewInSeasonTooltip")),1)]),_:1})],64)):i.value===0?(u(),T(y,{key:1},{default:o(()=>[b(n(t.$t("ladderTable.previousSeasonChangeNoChangeTooltip")),1)]),_:1})):i.value>0?(u(),$(Q,{key:2},[s("div",pt,n(i.value),1),i.value==-1?(u(),T(y,{key:0},{default:o(()=>[b(n(c(r)("ladderTable.previousSeasonChangeWorseTooltip.n1")),1)]),_:1})):i.value>-5?(u(),T(y,{key:1},{default:o(()=>[b(n(c(r)("ladderTable.previousSeasonChangeWorseTooltip.n2",i.value)),1)]),_:2},1024)):(u(),T(y,{key:2},{default:o(()=>[b(n(c(r)("ladderTable.previousSeasonChangeWorseTooltip.n5",i.value)),1)]),_:2},1024))],64)):i.value<0?(u(),$(Q,{key:3},[s("div",Tt,n(-i.value),1),i.value==-1?(u(),T(y,{key:0},{default:o(()=>[b(n(c(r)("ladderTable.previousSeasonChangeBetterTooltip.n1")),1)]),_:1})):i.value>-5?(u(),T(y,{key:1},{default:o(()=>[b(n(c(r)("ladderTable.previousSeasonChangeBetterTooltip.n2",-i.value)),1)]),_:2},1024)):(u(),T(y,{key:2},{default:o(()=>[b(n(c(r)("ladderTable.previousSeasonChangeBetterTooltip.n5",-i.value)),1)]),_:2},1024))],64)):P("",!0)]),_:2},1032,["props"])]),"body-cell-details":o(i=>[m(X,{props:i},{default:o(()=>[m(B,{onClick:N=>f(i.row),flat:"",dense:"",round:"",icon:"mdi-information-outline"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","loading","style"])):(u(),$("div",yt,[s("div",xt,n(t.$t("noData")),1)])),c(v)!==null?(u(),T(_t,{key:2,modelValue:c(g),"onUpdate:modelValue":p[0]||(p[0]=i=>ie(g)?g.value=i:g=i),onTournamentDetail:x},null,8,["modelValue"])):P("",!0)],64))}});export{Dt as default};
